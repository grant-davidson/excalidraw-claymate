(this["webpackJsonpexcalidraw-claymate"]=this["webpackJsonpexcalidraw-claymate"]||[]).push([[0],{139:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),c=t(23),o=t.n(c),r=(t(46),t(6)),l=t.n(r),d=(t(70),t(4)),u=t(1),s=t.n(u),f=t(2),m=(t(71),t(17)),g=t(38),h=t.n(g),v=function(e){return new Promise((function(n){var t=new h.a;e.forEach((function(n,a){var i=a+1===e.length;t.addFrame(n.imageData,{delay:i?2e3:500})})),t.on("finished",(function(e){Object(m.a)(e,{fileName:"excalidraw-claymate.gif"}).then(n)})),t.render()}))},b=function(){var e=Object(f.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t='<!DOCTYPE html>\n    <html lang="en">\n      <style>\n        svg { width: 100%; height: 100%; }\n        body { margin: 0px; font-size: 24px; }\n        button { background: transparent; border: none; cursor: pointer; padding: 3px; margin: 0px 10px; font-size: inherit;}\n        #container { display: flex; flex-direction: column; height: 100%; }\n        #navigation { display: flex; justify-content: center; align-items: center; padding: 5px; border-top: 1px solid lightgray; background: white; }        \n        #rightbuttons { position: absolute; right: 10px; display: flex;  }\n        #slides { height: calc(100vh - 50px); }                \n      </style>\n      <script>\n        let index = 0;\n        let totalScenes = '.concat(n.length,"\n        function updateTitle() {\n          document.getElementById('title').innerText = index+1 + \" of \" + totalScenes;\n        }\n        function moveLeft() {\n          if (index > 0) {\n            document.getElementById('scene' + index).style.display = 'none';\n            index -= 1;\n            document.getElementById('scene' + index).style.display = 'block';\n            updateTitle();\n          }\n        }\n        function moveRight() {\n          if (index < totalScenes - 1) {\n            document.getElementById('scene' + index).style.display = 'none';\n            index += 1;\n            document.getElementById('scene' + index).style.display = 'block';\n            updateTitle();\n          }\n        }\n        function closeNavigation() {\n          document.getElementById('navigation').style.display = 'none';\n          document.getElementById('slides').style.height = \"100vh\";\n        }\n        function toggleMaximise() {\n          if (document.fullscreenElement === document.body) {\n            document.exitFullscreen();\n          } else {\n            document.body.requestFullscreen();\n          }\n        }\n        document.addEventListener('DOMContentLoaded', () => {\n          document.getElementById('scene' + index).style.display = 'block';          \n        });\n        document.addEventListener('keydown', (event) => {\n          if (event.key === 'ArrowRight') {\n            moveRight();\n          }\n          if (event.key === 'ArrowLeft') {\n            moveLeft();\n          }\n          if (event.key.toLowerCase() === \"f\") {\n            toggleMaximise();            \n          }\n        });\n      <\/script>\n      <body>\n      <div id=\"container\">\n      <div id=\"slides\">\n  "),n.forEach((function(e,n){var a=Object(r.exportToSvg)(e.drawing);a.id="scene".concat(n),a.style.display="none",t+=a.outerHTML})),t+='</div>\n            <div id="navigation">\n              <button class="navbutton" type="button" onClick="moveLeft()">&#9664;</button>\n              <div id="title">1 of '.concat(n.length,'</div>\n              <button class="navbutton" type="button" onClick="moveRight()">&#9654;</button>          \n              <div id="rightbuttons">\n                <button type="button" onClick="toggleMaximise()">&#x26F6</button>\n                <button type="button" onClick="closeNavigation()">&#x2716;</button>\n              <div>\n            </div>\n        </div></body></html>'),e.next=5,Object(m.a)(new Blob([t],{type:"text/html"}),{fileName:"excalidraw-claymate.html"});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),p=t(39),y=function(e){var n=e.scene,t=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(t.current){var e=t.current.getContext("2d");e&&e.putImageData(n.imageData,0,0)}}),[n]),i.a.createElement("canvas",{ref:t,width:n.width,height:n.height})},x=function(e){var n=e.scenes,t=e.currentIndex,c=e.updateScenes,o=e.moveToScene,r=e.addScene,l=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(n);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(f.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(n);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){0===n.length&&r()}),[n,r]),i.a.createElement("div",{className:"Claymate"},i.a.createElement("div",{className:"Claymate-scenes"},n.map((function(e,a){var r="MissingId";return Object(p.isEmpty)(n[a].drawing.elements)||(r=n[a].drawing.elements[0].id),i.a.createElement("div",{key:e.id,className:"Claymate-scene ".concat(a===t?"Claymate-current-scene":""),onClick:function(){return o(a)},"data-testid":r},i.a.createElement(y,{scene:e}),i.a.createElement("button",{type:"button",className:"Claymate-delete","aria-label":"Delete",disabled:n.length<=1,onClick:function(a){a.stopPropagation(),function(e){var a=n.findIndex((function(n){return n.id===e}));if(a>=0){var i=n.length-1;if(i>0){var o;if(void 0!==t){var r=a===t;if(t>a||r){var l=t;r&&(t===i?l=t-1:0===t&&(l=1)),o={index:t>0?t-1:t,drawing:n[l].drawing}}}c((function(n){return n.filter((function(n){return n.id!==e}))}),o)}}}(e.id)}},"\u2716"),i.a.createElement("button",{type:"button",className:"Claymate-left","aria-label":"Move Left",disabled:0===a,onClick:function(t){t.stopPropagation(),function(e){var t=n.findIndex((function(n){return n.id===e}));c((function(e){var n=Object(d.a)(e);return n[t-1]=e[t],n[t]=e[t-1],n}),{index:t-1,drawing:n[t].drawing})}(e.id)}},"\u2b05"),i.a.createElement("button",{type:"button",className:"Claymate-right","aria-label":"Move Right",disabled:a===n.length-1,onClick:function(t){t.stopPropagation(),function(e){var t=n.findIndex((function(n){return n.id===e}));c((function(e){var n=Object(d.a)(e);return n[t+1]=e[t],n[t]=e[t+1],n}),{index:t+1,drawing:n[t].drawing})}(e.id)}},"\u27a1"))}))),i.a.createElement("div",{className:"Claymate-buttons"},i.a.createElement("button",{type:"button",onClick:r},"Add scene"),i.a.createElement("button",{type:"button",onClick:l,disabled:0===n.length},"Export GIF"),i.a.createElement("button",{type:"button",onClick:u,disabled:0===n.length},"Export HTML"),i.a.createElement("button",{type:"button",onClick:function(){c((function(e){return Object(d.a)(e).reverse()}),void 0!==t?{index:n.length-1-t,drawing:n[t].drawing}:void 0)},disabled:n.length<=1},"Reverse order")))},w=t(9),O=t(7),E=t(24),j=t.n(E),k=t(40),C=function(e,n){var t=Object(r.exportToCanvas)({elements:e.elements}),a=n?n.width:t.width,i=n?n.height:t.height,c=t.getContext("2d");if(c)return{id:Object(k.a)(),width:a,height:i,imageData:c.getImageData(0,0,a,i),drawing:e}},S=function(){try{var e,n=JSON.parse(localStorage.getItem("claymate-scenes")||"");if(n&&n.length>0)return n.map((function(n){n.appState.collaborators=new Map;var t=C(n,e?{width:e.width,height:e.height}:void 0);return void 0===e&&(e=t),t}))}catch(i){try{var t=function(){try{var e=JSON.parse(localStorage.getItem("excalidraw-elements")||"");return e.appState.collaborators=new Map,e}catch(n){return null}}();if(t){var a=C(t);if(a)return[a]}}catch(c){}}return null},I=function(){var e=Object(a.useState)(!1),n=Object(O.a)(e,2),t=n[0],i=n[1],c=Object(a.useState)(0),o=Object(O.a)(c,2),r=o[0],l=o[1],u=Object(a.useState)(0),s=Object(O.a)(u,2),f=s[0],m=s[1],g=Object(a.useState)([]),h=Object(O.a)(g,2),v=h[0],b=h[1],p=Object(a.useState)(),y=Object(O.a)(p,2),x=y[0],E=y[1];Object(a.useEffect)((function(){if(!t){var e=S();e&&e.length>0&&(b(e),m(0),E(e[0].drawing))}}),[t,i]),Object(a.useEffect)((function(){!function(e){var n=JSON.stringify(e.map((function(e){return e.drawing})));localStorage.setItem("claymate-scenes",n)}(v)}),[v]);var k,I,N=Object(a.useCallback)((function(e){l((function(e){return e+1})),E(e)}),[]),T=Object(a.useCallback)((function(e){N(v[e].drawing),m(e)}),[N,m,v]),M=Object(a.useCallback)((function(e,n){b(e),n&&(N(n.drawing),m(n.index))}),[m,N,b]),B=void 0!==f&&f<v.length?Object(w.a)(Object(w.a)({},v[f]),{},{drawing:x}):void 0;null!=B&&1!==v.length&&(k=B.width,I=B.height),Object(a.useEffect)((function(){if(null!=f&&x){var e=C(x,void 0===k||void 0===I?void 0:{width:k,height:I});e&&M((function(n){var t=Object(d.a)(n);return t[f]=e,t}),void 0)}}),[x,f,v.length,M,k,I]);var D=Object(a.useCallback)((function(){if(x){var e=C(x,v[0]&&{width:v[0].width,height:v[0].height});e&&M((function(n){return[].concat(Object(d.a)(n),[e])}),{index:v.length,drawing:x})}}),[M,v,x]);return{initialised:t,moveToScene:T,addScene:D,onChange:function(e,n){if(null==x||!j()(e,x.elements)||!j()(n,x.appState)){var t={elements:e.map((function(e){return Object(w.a)({},e)})),appState:Object(w.a)({},n)};E(t)}},drawingVersion:r,currentIndex:f,scenes:v,updateScenes:M,initialData:x}},N=function(){var e=I(),n=e.moveToScene,t=e.addScene,a=e.onChange,c=e.drawingVersion,o=e.currentIndex,r=e.initialData,d=e.scenes,u=e.updateScenes;return i.a.createElement("div",{className:"ClaymateApp"},i.a.createElement(l.a,{key:c,initialData:r,onChange:a}),i.a.createElement(x,{scenes:d,currentIndex:o,updateScenes:u,moveToScene:n,addScene:t}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},41:function(e,n,t){e.exports=t(139)},46:function(e,n,t){},70:function(e,n,t){},71:function(e,n,t){}},[[41,1,2]]]);
//# sourceMappingURL=main.9cf9078b.chunk.js.map