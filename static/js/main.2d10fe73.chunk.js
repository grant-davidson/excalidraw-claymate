(this["webpackJsonpexcalidraw-claymate"]=this["webpackJsonpexcalidraw-claymate"]||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(20),c=n.n(r),o=(n(45),n(7)),u=n(3),l=n(35),d=n.n(l),s=n(21),f=n.n(s),h=(n(136),n(6)),g=n(1),m=n.n(g),b=n(4),w=n(39),v=n(38),p=n(36),O=n.n(p),j=n(37),E=(n(137),"Any unsaved changes will be lost.  Are you sure?"),y=function(e,t){var n=Object(j.exportToCanvas)({elements:e.elements}),a=t?t.width:n.width,i=t?t.height:n.height,r=n.getContext("2d");return{id:Object(w.a)(),width:a,height:i,imageData:r.getImageData(0,0,a,i),drawing:e}},C=function(e){var t=e.scene,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(n.current){var e=n.current.getContext("2d");e&&e.putImageData(t.imageData,0,0)}}),[t]),i.a.createElement("canvas",{ref:n,width:t.width,height:t.height})},x=function(e){var t,n,r=e.drawing,c=e.onRestore,l=Object(a.useState)(),d=Object(u.a)(l,2),s=d[0],f=d[1],g=Object(a.useState)([]),w=Object(u.a)(g,2),p=w[0],j=w[1],x=function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1],r=Object(a.useCallback)((function(e){if(n)return e?(e.returnValue=E,e.preventDefault(),e):E}),[n]);return Object(a.useEffect)((function(){return window.addEventListener("beforeunload",r),function(){window.removeEventListener("beforeunload",r)}}),[r]),i}(),k=void 0!==s&&s<p.length?Object(o.a)(Object(o.a)({},p[s]),{},{drawing:r}):void 0,S=Object(a.useCallback)((function(e,t){j(e),x(!0),t&&(c(t.drawing),f(t.index))}),[x,f,c]),N=Object(a.useCallback)((function(){if(r){var e=y(r,p[0]&&{width:p[0].width,height:p[0].height});S((function(t){return[].concat(Object(h.a)(t),[e])}),{index:p.length,drawing:r})}}),[S,p,r]);return Object(a.useEffect)((function(){0===p.length&&N()}),[p,N]),null!=k&&1!==p.length&&(t=k.width,n=k.height),Object(a.useEffect)((function(){if(null!=s){var e=y(r,void 0===t||void 0===n?void 0:{width:t,height:n});S((function(t){var n=Object(h.a)(t);return n[s]=e,n}),void 0)}}),[r,s,p.length,S,t,n]),i.a.createElement("div",{className:"Claymate"},i.a.createElement("div",{className:"Claymate-scenes"},p.map((function(e,t){return i.a.createElement("div",{key:e.id,className:"Claymate-scene ".concat(t===s?"Claymate-current-scene":""),onClick:function(){return function(e){c(p[e].drawing),f(e)}(t)}},i.a.createElement(C,{scene:e}),i.a.createElement("button",{type:"button",className:"Claymate-delete","aria-label":"Delete",onClick:function(t){t.stopPropagation(),function(e){var t=p.findIndex((function(t){return t.id===e}));if(t>=0){var n,a=p.length-1;a>0&&(n=t<a?t:a-1);var i=void 0!==n?{index:n,drawing:p[n].drawing}:void 0;S((function(t){return t.filter((function(t){return t.id!==e}))}),i)}}(e.id)}},"\u2716"),i.a.createElement("button",{type:"button",className:"Claymate-left","aria-label":"Move Left",disabled:0===t,onClick:function(t){t.stopPropagation(),function(e){var t=p.findIndex((function(t){return t.id===e}));S((function(e){var n=Object(h.a)(e);return n[t-1]=e[t],n[t]=e[t-1],n}),{index:t-1,drawing:p[t].drawing})}(e.id)}},"\u2b05"),i.a.createElement("button",{type:"button",className:"Claymate-right","aria-label":"Move Right",disabled:t===p.length-1,onClick:function(t){t.stopPropagation(),function(e){var t=p.findIndex((function(t){return t.id===e}));S((function(e){var n=Object(h.a)(e);return n[t+1]=e[t],n[t]=e[t+1],n}),{index:t+1,drawing:p[t].drawing})}(e.id)}},"\u27a1"))}))),i.a.createElement("div",{className:"Claymate-buttons"},i.a.createElement("button",{type:"button",onClick:N},"Add scene"),i.a.createElement("button",{type:"button",onClick:function(){var e=new O.a;p.forEach((function(t){e.addFrame(t.imageData)})),e.on("finished",function(){var e=Object(b.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)(t,{fileName:"excalidraw-claymate.gif"});case 2:x(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.render()},disabled:0===p.length},"Export GIF"),i.a.createElement("button",{type:"button",onClick:function(){S((function(e){return Object(h.a)(e).reverse()}),void 0!==s?{index:p.length-1-s,drawing:p[s].drawing}:void 0)},disabled:p.length<=1},"Reverse order")))},k=function(){try{var e=JSON.parse(localStorage.getItem("excalidraw-elements")||"");return e.appState.collaborators=new Map,e}catch(t){return null}}(),S=function(){var e=Object(a.useState)(k),t=Object(u.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(0),l=Object(u.a)(c,2),s=l[0],h=l[1],g=Object(a.useState)({width:window.innerWidth,height:window.innerHeight}),m=Object(u.a)(g,2),b=m[0],w=m[1];Object(a.useEffect)((function(){var e=function(){w({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var v=b.width,p=b.height;return i.a.createElement("div",{className:"ClaymateApp"},i.a.createElement(d.a,{key:s,width:v,height:p,initialData:k,onChange:function(e,t){var a;null!=n&&f()(e,n.elements)&&f()(t,n.appState)||r({elements:e.map((function(e){return Object(o.a)({},e)})),appState:Object(o.a)({},t)}),a={elements:e,appState:t},localStorage.setItem("excalidraw-elements",JSON.stringify(a))}}),i.a.createElement(x,{drawing:n,onRestore:function(e){h((function(e){return e+1})),k=e}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},40:function(e,t,n){e.exports=n(138)},45:function(e,t,n){}},[[40,1,2]]]);
//# sourceMappingURL=main.2d10fe73.chunk.js.map